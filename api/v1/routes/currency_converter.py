from fastapi import APIRouter, HTTPException
from enum import Enum
import requests
from typing import Literal

currency_converter = APIRouter()


CURRENCY_LIST_API = "https://v6.exchangerate-api.com/v6/ccbc47815dd70fdb8f65ff3d/codes"


# class RateSource(str, Enum):
#     Exc = "Fast Price Exchange Rates"
    
class Currency(str, Enum):
    _00 = "00"
    _1INCH = "1INCH"
    AAVE = "AAVE"
    ABT = "ABT"
    ACA = "ACA"
    ACE = "ACE"
    ACH = "ACH"
    ACS = "ACS"
    ACT = "ACT"
    ACX = "ACX"
    ADA = "ADA"
    AERGO = "AERGO"
    AERO = "AERO"
    AEVO = "AEVO"
    AGLD = "AGLD"
    AI16Z = "AI16Z"
    AIDOGE = "AIDOGE"
    AIOZ = "AIOZ"
    AKT = "AKT"
    ALCX = "ALCX"
    ALEO = "ALEO"
    ALEPH = "ALEPH"
    ALGO = "ALGO"
    ALICE = "ALICE"
    ALPHA = "ALPHA"
    AMP = "AMP"
    ANKR = "ANKR"
    APE = "APE"
    API3 = "API3"
    APT = "APT"
    AR = "AR"
    ARB = "ARB"
    ARG = "ARG"
    ARKM = "ARKM"
    ARPA = "ARPA"
    ARTY = "ARTY"
    ASM = "ASM"
    AST = "AST"
    ASTR = "ASTR"
    ATH = "ATH"
    ATOM = "ATOM"
    AUCTION = "AUCTION"
    AUDIO = "AUDIO"
    AURORA = "AURORA"
    AVAX = "AVAX"
    AVT = "AVT"
    AXL = "AXL"
    AXS = "AXS"
    BABYDOGE = "BABYDOGE"
    BADGER = "BADGER"
    BAL = "BAL"
    BANANA = "BANANA"
    BAND = "BAND"
    BAT = "BAT"
    BCH = "BCH"
    BETH = "BETH"
    BICO = "BICO"
    BIGTIME = "BIGTIME"
    BLAST = "BLAST"
    BLUR = "BLUR"
    BLZ = "BLZ"
    BNB = "BNB"
    BNT = "BNT"
    BOBA = "BOBA"
    BOME = "BOME"
    BONE = "BONE"
    BONK = "BONK"
    BORA = "BORA"
    BSV = "BSV"
    BTC = "BTC"
    BTRST = "BTRST"
    BTT = "BTT"
    BZZ = "BZZ"
    C98 = "C98"
    CAT = "CAT"
    CBETH = "CBETH"
    CELO = "CELO"
    CELR = "CELR"
    CETUS = "CETUS"
    CFG = "CFG"
    CFX = "CFX"
    CHZ = "CHZ"
    CITY = "CITY"
    CLV = "CLV"
    COMP = "COMP"
    CORE = "CORE"
    COTI = "COTI"
    COW = "COW"
    CRO = "CRO"
    CRV = "CRV"
    CSPR = "CSPR"
    CTC = "CTC"
    CTSI = "CTSI"
    CTX = "CTX"
    CTXC = "CTXC"
    CVC = "CVC"
    CVX = "CVX"
    CXT = "CXT"
    DAI = "DAI"
    DAO = "DAO"
    DAR = "DAR"
    DASH = "DASH"
    DEGEN = "DEGEN"
    DEP = "DEP"
    DEXT = "DEXT"
    DGB = "DGB"
    DIA = "DIA"
    DIMO = "DIMO"
    DNT = "DNT"
    DOGE = "DOGE"
    DOGS = "DOGS"
    DORA = "DORA"
    DOT = "DOT"
    DRIFT = "DRIFT"
    DYDX = "DYDX"
    EGLD = "EGLD"
    EIGEN = "EIGEN"
    ELA = "ELA"
    ELF = "ELF"
    ELON = "ELON"
    ENJ = "ENJ"
    ENS = "ENS"
    EOS = "EOS"
    ERN = "ERN"
    ETC = "ETC"
    ETH = "ETH"
    ETHFI = "ETHFI"
    ETHW = "ETHW"
    EURT = "EURT"
    FARM = "FARM"
    FARTCOIN = "FARTCOIN"
    FET = "FET"
    FIDA = "FIDA"
    FIL = "FIL"
    FIS = "FIS"
    FLM = "FLM"
    FLOKI = "FLOKI"
    FLOW = "FLOW"
    FLR = "FLR"
    FORT = "FORT"
    FORTH = "FORTH"
    FOX = "FOX"
    FOXY = "FOXY"
    FX = "FX"
    FXS = "FXS"
    G = "G"
    GAL = "GAL"
    GALA = "GALA"
    GAS = "GAS"
    GEAR = "GEAR"
    GFI = "GFI"
    GHST = "GHST"
    GIGA = "GIGA"
    GLM = "GLM"
    GLMR = "GLMR"
    GMT = "GMT"
    GMX = "GMX"
    GNO = "GNO"
    GOAL = "GOAL"
    GOAT = "GOAT"
    GODS = "GODS"
    GOG = "GOG"
    GPT = "GPT"
    GRT = "GRT"
    GST = "GST"
    GTC = "GTC"
    GUSD = "GUSD"
    GYEN = "GYEN"
    HBAR = "HBAR"
    HFT = "HFT"
    HIGH = "HIGH"
    HMSTR = "HMSTR"
    HNT = "HNT"
    HONEY = "HONEY"
    HOPR = "HOPR"
    ICP = "ICP"
    ICX = "ICX"
    ID = "ID"
    IDES = "IDES"
    IDEX = "IDEX"
    ILV = "ILV"
    IMX = "IMX"
    INDEX = "INDEX"
    INJ = "INJ"
    INV = "INV"
    IO = "IO"
    IOST = "IOST"
    IOTA = "IOTA"
    IOTX = "IOTX"
    IQ = "IQ"
    JASMY = "JASMY"
    JOE = "JOE"
    JST = "JST"
    JTO = "JTO"
    JUP = "JUP"
    KAIA = "KAIA"
    KARRAT = "KARRAT"
    KAVA = "KAVA"
    KDA = "KDA"
    KISHU = "KISHU"
    KNC = "KNC"
    KP3R = "KP3R"
    KSM = "KSM"
    LAMB = "LAMB"
    LAT = "LAT"
    LBR = "LBR"
    LCX = "LCX"
    LDO = "LDO"
    LEO = "LEO"
    LINK = "LINK"
    LIT = "LIT"
    LOKA = "LOKA"
    LOOKS = "LOOKS"
    LPT = "LPT"
    LQTY = "LQTY"
    LRC = "LRC"
    LRDS = "LRDS"
    LSETH = "LSETH"
    LSK = "LSK"
    LTC = "LTC"
    LUNA = "LUNA"
    LUNC = "LUNC"
    MAGIC = "MAGIC"
    MANA = "MANA"
    MASK = "MASK"
    MATH = "MATH"
    MATIC = "MATIC"
    MAX = "MAX"
    MDT = "MDT"
    MEDIA = "MEDIA"
    MEME = "MEME"
    MENGO = "MENGO"
    MERL = "MERL"
    METIS = "METIS"
    MEW = "MEW"
    MILO = "MILO"
    MINA = "MINA"
    MKR = "MKR"
    MLN = "MLN"
    MNDE = "MNDE"
    MOBILE = "MOBILE"
    MOG = "MOG"
    MOODENG = "MOODENG"
    MOVE = "MOVE"
    MOVR = "MOVR"
    MPL = "MPL"
    MSOL = "MSOL"
    MUSE = "MUSE"
    MXC = "MXC"
    NCT = "NCT"
    NEAR = "NEAR"
    NEIRO = "NEIRO"
    NEO = "NEO"
    NEON = "NEON"
    NFT = "NFT"
    NKN = "NKN"
    NMR = "NMR"
    NOT = "NOT"
    NULS = "NULS"
    OAS = "OAS"
    OCEAN = "OCEAN"
    OGN = "OGN"
    OKB = "OKB"
    OKT = "OKT"
    OM = "OM"
    OMI = "OMI"
    ONDO = "ONDO"
    ONE = "ONE"
    ONT = "ONT"
    OP = "OP"
    ORBS = "ORBS"
    ORCA = "ORCA"
    ORDI = "ORDI"
    ORN = "ORN"
    OSMO = "OSMO"
    OXT = "OXT"
    PAX = "PAX"
    PENDLE = "PENDLE"
    PEOPLE = "PEOPLE"
    PEPE = "PEPE"
    PERP = "PERP"
    PHA = "PHA"
    PIXEL = "PIXEL"
    PLU = "PLU"
    PNG = "PNG"
    PNUT = "PNUT"
    POL = "POL"
    POLS = "POLS"
    POLYDOGE = "POLYDOGE"
    POND = "POND"
    POR = "POR"
    POWR = "POWR"
    PRCL = "PRCL"
    PRIME = "PRIME"
    PRO = "PRO"
    PRQ = "PRQ"
    PSTAKE = "PSTAKE"
    PUNDIX = "PUNDIX"
    PYR = "PYR"
    PYTH = "PYTH"
    PYUSD = "PYUSD"
    QI = "QI"
    QNT = "QNT"
    QTUM = "QTUM"
    RACA = "RACA"
    RAD = "RAD"
    RADAR = "RADAR"
    RARE = "RARE"
    RARI = "RARI"
    RAY = "RAY"
    RBN = "RBN"
    RDNT = "RDNT"
    RENDER = "RENDER"
    REQ = "REQ"
    RIO = "RIO"
    RLC = "RLC"
    RNDR = "RNDR"
    RON = "RON"
    ROSE = "ROSE"
    RPL = "RPL"
    RSR = "RSR"
    RSS3 = "RSS3"
    RVN = "RVN"
    SAFE = "SAFE"
    SAMO = "SAMO"
    SAND = "SAND"
    SATS = "SATS"
    SC = "SC"
    SCR = "SCR"
    SD = "SD"
    SEAM = "SEAM"
    SEI = "SEI"
    SHDW = "SHDW"
    SHIB = "SHIB"
    SHPING = "SHPING"
    SKL = "SKL"
    SLERF = "SLERF"
    SLP = "SLP"
    SNT = "SNT"
    SNX = "SNX"
    SOL = "SOL"
    SONIC = "SONIC"
    SPA = "SPA"
    SPELL = "SPELL"
    SPURS = "SPURS"
    SSV = "SSV"
    SSWP = "SSWP"
    STETH = "STETH"
    STG = "STG"
    STORJ = "STORJ"
    STRK = "STRK"
    STX = "STX"
    SUI = "SUI"
    SUKU = "SUKU"
    SUPER = "SUPER"
    SUSHI = "SUSHI"
    SWEAT = "SWEAT"
    SWFTC = "SWFTC"
    SYN = "SYN"
    T = "T"
    THETA = "THETA"
    TIA = "TIA"
    TIME = "TIME"
    TNSR = "TNSR"
    TON = "TON"
    TOSHI = "TOSHI"
    TRA = "TRA"
    TRAC = "TRAC"
    TRB = "TRB"
    TRU = "TRU"
    TRUMP = "TRUMP"
    TRX = "TRX"
    TURBO = "TURBO"
    ULTI = "ULTI"
    UMA = "UMA"
    UNI = "UNI"
    USDC = "USDC"
    USDG = "USDG"
    USDT = "USDT"
    UST = "UST"
    USTC = "USTC"
    UXLINK = "UXLINK"
    VARA = "VARA"
    VELO = "VELO"
    VENOM = "VENOM"
    VET = "VET"
    VOXEL = "VOXEL"
    VRA = "VRA"
    VTHO = "VTHO"
    W = "W"
    WAXL = "WAXL"
    WAXP = "WAXP"
    WBTC = "WBTC"
    WELL = "WELL"
    WIF = "WIF"
    WIN = "WIN"
    WLD = "WLD"
    WOO = "WOO"
    X = "X"
    XAUT = "XAUT"
    XCH = "XCH"
    XCN = "XCN"
    XLM = "XLM"
    XNO = "XNO"
    XR = "XR"
    XRP = "XRP"
    XTZ = "XTZ"
    XYO = "XYO"
    YFI = "YFI"
    YGG = "YGG"
    ZBCN = "ZBCN"
    ZEC = "ZEC"
    ZEN = "ZEN"
    ZENT = "ZENT"
    ZERO = "ZERO"
    ZETA = "ZETA"
    ZEUS = "ZEUS"
    ZIL = "ZIL"
    ZK = "ZK"
    ZRO = "ZRO"
    ZRX = "ZRX"
    AED = "AED"
    AFN = "AFN"
    ALL = "ALL"
    AMD = "AMD"
    ANG = "ANG"
    AOA = "AOA"
    ARS = "ARS"
    AUD = "AUD"
    AWG = "AWG"
    AZN = "AZN"
    BAM = "BAM"
    BBD = "BBD"
    BDT = "BDT"
    BGN = "BGN"
    BHD = "BHD"
    BIF = "BIF"
    BMD = "BMD"
    BND = "BND"
    BOB = "BOB"
    BRL = "BRL"
    BSD = "BSD"
    BTN = "BTN"
    BWP = "BWP"
    BZD = "BZD"
    CAD = "CAD"
    CDF = "CDF"
    CHF = "CHF"
    CLP = "CLP"
    CNY = "CNY"
    COP = "COP"
    CUP = "CUP"
    CVE = "CVE"
    CZK = "CZK"
    DJF = "DJF"
    DKK = "DKK"
    DOP = "DOP"
    DZD = "DZD"
    EGP = "EGP"
    ETB = "ETB"
    EUR = "EUR"
    FJD = "FJD"
    FKP = "FKP"
    GBP = "GBP"
    GEL = "GEL"
    GHS = "GHS"
    GIP = "GIP"
    GMD = "GMD"
    GNF = "GNF"
    GTQ = "GTQ"
    GYD = "GYD"
    HKD = "HKD"
    HNL = "HNL"
    HTG = "HTG"
    HUF = "HUF"
    IDR = "IDR"
    ILS = "ILS"
    INR = "INR"
    IQD = "IQD"
    IRR = "IRR"
    ISK = "ISK"
    JMD = "JMD"
    JOD = "JOD"
    JPY = "JPY"
    KES = "KES"
    KGS = "KGS"
    KHR = "KHR"
    KMF = "KMF"
    KPW = "KPW"
    KRW = "KRW"
    KWD = "KWD"
    KYD = "KYD"
    KZT = "KZT"
    LAK = "LAK"
    LBP = "LBP"
    LKR = "LKR"
    LRD = "LRD"
    LSL = "LSL"
    LYD = "LYD"
    MAD = "MAD"
    MDL = "MDL"
    MGA = "MGA"
    MKD = "MKD"
    MMK = "MMK"
    MNT = "MNT"
    MOP = "MOP"
    MRU = "MRU"
    MUR = "MUR"
    MVR = "MVR"
    MWK = "MWK"
    MXN = "MXN"
    MYR = "MYR"
    MZN = "MZN"
    NAD = "NAD"
    NGN = "NGN"
    NOK = "NOK"
    NPR = "NPR"
    NZD = "NZD"
    OMR = "OMR"
    PAB = "PAB"
    PEN = "PEN"
    PGK = "PGK"
    PHP = "PHP"
    PKR = "PKR"
    PLN = "PLN"
    PYG = "PYG"
    QAR = "QAR"
    RSD = "RSD"
    RUB = "RUB"
    RWF = "RWF"
    SAR = "SAR"
    SDG = "SDG"
    SEK = "SEK"
    SGD = "SGD"
    SHP = "SHP"
    SLL = "SLL"
    SOS = "SOS"
    SRD = "SRD"
    SYP = "SYP"
    SZL = "SZL"
    THB = "THB"
    TJS = "TJS"
    TMT = "TMT"
    TND = "TND"
    TOP = "TOP"
    TRY = "TRY"
    TTD = "TTD"
    TWD = "TWD"
    TZS = "TZS"
    UAH = "UAH"
    UGX = "UGX"
    USD = "USD"
    UYU = "UYU"
    UZS = "UZS"
    VND = "VND"
    VUV = "VUV"
    WST = "WST"
    XAF = "XAF"
    XCD = "XCD"
    XOF = "XOF"
    XPF = "XPF"
    YER = "YER"
    ZAR = "ZAR"
    ZMW = "ZMW"
    
    
    
# def get_supported_currencies():
#     """Fetch and return a list of supported currencies."""
#     response = requests.get(CURRENCY_LIST_API)

#     if response.status_code != 200:
#         return ["GHS", "USD", "EUR", "GBP"]

#     data = response.json()
#     return [currency[0] for currency in data.get("supported_codes", [])]


# currencies_list = get_supported_currencies()

# Dynamically create an Enum for currencies
# CurrencyEnum = Enum("CurrencyEnum", {cur: cur for cur in currencies_list})


@currency_converter.get("/currency-converter", tags=["Currency Converter"])
# def convert_currency(api_provider: RateSource, api_key: str, amount: float, from_currency: CurrencyEnum, to_currency: CurrencyEnum):
def convert_currency(amount: float, from_currency: Currency, to_currency: Currency):
    """Converts currency from one to another using live exchange rates."""
    # from_currency.name
    # EXCHANGE_API_URL = f"https://v6.exchangerate-api.com/v6/{api_key}/pair/"
    # response = requests.get(f"{EXCHANGE_API_URL}{from_currency.name}/{to_currency.name}/{amount}")
    
    
    url = "https://fast-price-exchange-rates.p.rapidapi.com/api/v1/convert"

    querystring = {"amount": amount, "base_currency": from_currency, "quote_currency": to_currency}

    headers = {
        "x-rapidapi-key": "b97ac7d537mshc947e075f1ff5a0p134b39jsnff97c7acd4b4",
        "x-rapidapi-host": "fast-price-exchange-rates.p.rapidapi.com"
    }

    response = requests.get(url, headers=headers, params=querystring)
    if response.status_code != 200:
        raise HTTPException(status_code=400, detail="Invalid currency or API error")
    result = response.json()
    
    return {
        "amount": amount,
        "from_currency": from_currency,
        "to_currency": to_currency,
        # "rate": round(result['conversion_rate'], 2),
        "converted_amount": (result['to'][to_currency]),
    }